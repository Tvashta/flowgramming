<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
        />
        <title>Contest List</title>
        <link
            rel="stylesheet"
            href="../assets/bootstrap/css/bootstrap.min.css"
        />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i"
        />
        <link rel="stylesheet" href="../assets/fonts/ionicons.min.css" />
        <link rel="stylesheet" href="../css/Contact-Form-Clean.css" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.css"
        />
        <link rel="stylesheet" href="../css/Login-Form-Clean.css" />
        <link rel="stylesheet" href="../css/vanilla-zoom.min.css" />
        <link rel="stylesheet" href="../css/app.css" />
    </head>

    <body>
        <nav
            class="navbar navbar-light navbar-expand-lg fixed-top bg-white clean-navbar"
        >
            <div class="container">
                <a class="navbar-brand logo" href="#">Flowgramming</a
                ><button
                    data-bs-toggle="collapse"
                    class="navbar-toggler"
                    data-bs-target="#navcol-1"
                >
                    <span class="visually-hidden">Toggle navigation</span
                    ><span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navcol-1">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="landing.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="problems.html"
                                >Problems</a
                            >
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="contests.html"
                                >Contest Page</a
                            >
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="login.html">LOGIN</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="profile.html">PROFILE</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <main class="page pricing-table-page">
            <section class="clean-block clean-pricing dark">
                <div class="container" id="allOngoingContestsDiv">
                </div>
                <div class="container" id="allContestsDiv">
                </div>

            </section>
        </main>
        <br><br><br><br><br><br><br><br><br>
        <footer class="page-footer dark">
            <div class="container">
                <div class="row">
                    <div class="col-sm-3">
                        <h5>Get started</h5>
                        <ul>
                            <li><a href="#">Home</a></li>
                            <li><a href="#">Login</a></li>
                        </ul>
                    </div>
                    <div class="col-sm-3">
                        <h5>About us</h5>
                        <ul>
                            <li><a href="#">Contact us</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
        <script src="assets/bootstrap/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.js"></script>
        <script src="assets/js/vanilla-zoom.js"></script>
        <script src="assets/js/theme.js"></script>
        <script
        src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
        crossorigin="anonymous"></script>
        <script src="js/build/codeVendor.js"></script>
        <script src="js/build/codeMain.js"></script>
        <script>
            $(document).on('click', '.openContest', function (event) {
                console.log("asdfg");
                let id = $(event.target).attr('data-id')
                window.open('viewContest.html', id);
            })
            window.onload = () => {
                fetch("http://localhost:5000/contest/ongoing")
                .then(res => res.json())
                .then(allContests=>{
                    let html = '<div class="block-heading">' +
                        '<h2 class="text-info">Ongoing Contests</h2>' +
                        '<p>Here is a list of all currently ongoing contests</p><br>' +
                        '<div class="table-responsive">' +
                            '<table class="table">' +
                                '<thead>' +
                                    '<tr>' +
                                        '<th>Contest ID</th>' +
                                        '<th>Contest Name</th>' +
                                        '<th>Start Time</th>' +
                                        '<th>End Time</th>' +
                                       ' <th>Authors</th>' +
                                    '</tr>' +
                                '</thead>' +
                                '<tbody>';
                
                allContests.map((contest, index) => {
                    html += '<tr>' +
                            '<td>'+'<span class="openContest" data-id="'+contest.contestID+'">'+contest.contestID+'</span>'+'</td>' +
                            '<td>'+contest.name+'</td>' +
                            '<td>'+new Date(contest.contestStartTime).toLocaleString("en-IN")+'</td>' +
                            '<td>'+new Date(contest.contestEndTime).toLocaleString("en-IN")+'</td>'
                    if(contest.organizer)
                        html += '<td>'+contest.organizer.firstName+' '+contest.organizer.lastName+'</td>';
                    else 
                        html += '<td>Test User</td>'
                    
                        html+='</tr>'
                });
                html += '</tbody>  </table> </div> </div>';
                $('#allOngoingContestsDiv').append(html)
                });


                fetch("http://localhost:5000/contest/all")
                .then(res => res.json())
                .then(allContests=>{
                    let html = '<div class="block-heading">' +
                        '<h2 class="text-info">All Contests</h2>' +
                        '<p>Here are a list of all contests</p><br>' +
                        '<div class="table-responsive">' +
                            '<table class="table">' +
                                '<thead>' +
                                    '<tr>' +
                                        '<th>Contest ID</th>' +
                                        '<th>Contest Name</th>' +
                                        '<th>Start Time</th>' +
                                        '<th>End Time</th>' +
                                       ' <th>Authors</th>' +
                                    '</tr>' +
                                '</thead>' +
                                '<tbody>';
                
                allContests.map((contest, index) => {
                    html += '<tr>' +
                            '<td><span class="openContest" data-id="'+contest.contestID+'">'+contest.contestID+'</span></td>' +
                            '<td>'+contest.name+'</td>' +
                            '<td>'+new Date(contest.contestStartTime).toLocaleString("en-IN")+'</td>' +
                            '<td>'+new Date(contest.contestEndTime).toLocaleString("en-IN")+'</td>'
                    if(contest.organizer)
                        html += '<td>'+contest.organizer.firstName+' '+contest.organizer.lastName+'</td>';
                    else 
                        html += '<td>Test User</td>'
                    
                        html+='</tr>'
                });
                html += '</tbody>  </table> </div> </div>';
                $('#allContestsDiv').append(html)
                });
            }

        </script>
        
    </body>
</html>
